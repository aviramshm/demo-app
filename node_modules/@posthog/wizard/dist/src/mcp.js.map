{"version":3,"file":"mcp.js","sourceRoot":"","sources":["../../src/mcp.ts"],"names":[],"mappings":"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","sourcesContent":["import chalk from 'chalk';\nimport {\n  addMCPServerToClientsStep,\n  removeMCPServerFromClientsStep,\n} from './steps/add-mcp-server-to-clients';\nimport clack from './utils/clack';\nimport { abort } from './utils/clack-utils';\nimport type { CloudRegion } from './utils/types';\nimport opn from 'opn';\nimport { getCloudUrlFromRegion } from './utils/urls';\nimport { sleep } from './lib/helper-functions';\nimport { enableDebugLogs } from './utils/debug';\n\nexport const runMCPInstall = async (options: {\n  signup: boolean;\n  region?: CloudRegion;\n  local?: boolean;\n  debug?: boolean;\n}) => {\n  if (options.debug) {\n    enableDebugLogs();\n  }\n  clack.intro(\n    chalk.bgGreenBright(\n      `Installing the PostHog MCP server ${options.local && '(local)'}`,\n    ),\n  );\n\n  await addMCPServerToClientsStep({\n    cloudRegion: options.region,\n    askPermission: false,\n    local: options.local,\n  });\n\n  clack.log.message(\n    `${chalk.greenBright(\n      'You might need to restart your MCP clients to see the changes.',\n    )}`,\n  );\n\n  clack.log.message(`Get started with some prompts like:\n- What feature flags do I have active?\n- Add a new feature flag for our homepage redesign\n- What are my most common errors?`);\n\n  clack.log.message(`Check out our MCP Server documentation:\n${chalk.blueBright(`https://posthog.com/docs/model-context-protocol`)}`);\n};\n\nexport const runMCPRemove = async (options?: { local?: boolean }) => {\n  clack.intro(chalk.bgRed('Removing the PostHog MCP server'));\n  const results = await removeMCPServerFromClientsStep({\n    local: options?.local,\n  });\n\n  if (results.length === 0) {\n    clack.outro(`No PostHog MCP servers found to remove.`);\n    return;\n  }\n\n  clack.log.success(`PostHog MCP server removed from:`);\n  results.map((c) => clack.log.message(`- ${c}`));\n  clack.outro(\n    `${chalk.green(\n      'You might need to restart your MCP clients to see the changes.\\n\\n',\n    )}`,\n  );\n};\n\nexport const getPersonalApiKey = async (options: {\n  cloudRegion: CloudRegion;\n}): Promise<string> => {\n  const cloudUrl = getCloudUrlFromRegion(options.cloudRegion);\n\n  const urlToOpen = `${cloudUrl}/settings/user-api-keys?preset=mcp_server`;\n\n  const spinner = clack.spinner();\n  spinner.start(\n    `Opening your project settings so you can get a Personal API key...`,\n  );\n\n  await sleep(1500);\n\n  spinner.stop(\n    `Opened your project settings. If the link didn't open automatically, open the following URL in your browser to get a Personal API key: \\n\\n${chalk.cyan(\n      urlToOpen,\n    )}`,\n  );\n\n  opn(urlToOpen, { wait: false }).catch(() => {\n    // opn throws in environments that don't have a browser (e.g. remote shells) so we just noop here\n  });\n\n  const personalApiKey = await clack.password({\n    message: 'Paste in your Personal API key:',\n    validate(value) {\n      if (value.length === 0) return `Value is required!`;\n\n      if (!value.startsWith('phx_')) {\n        return `That doesn't look right, are you sure you copied the right key? It should start with 'phx_'`;\n      }\n    },\n  });\n\n  if (!personalApiKey) {\n    await abort('Unable to proceed without a personal API key.');\n    return '';\n  }\n\n  return personalApiKey as string;\n};\n"]}