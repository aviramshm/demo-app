{"version":3,"file":"environment.js","sourceRoot":"","sources":["../../../src/utils/environment.ts"],"names":[],"mappings":";;;;;AAMA,kEAUC;AAED,0CAIC;AAED,gDAiEC;AAzFD,wDAA+B;AAC/B,+CAAkD;AAElD,0DAA2B;AAC3B,gDAA0C;AAE1C,SAAgB,2BAA2B;IACzC,IAAI,kBAAM,EAAE,CAAC;QACX,OAAO,KAAK,CAAC;IACf,CAAC;IAED,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;QACnD,OAAO,IAAI,CAAC;IACd,CAAC;IAED,OAAO,KAAK,CAAC;AACf,CAAC;AAED,SAAgB,eAAe;IAC7B,MAAM,MAAM,GAAG,IAAA,kBAAO,EAAC,gBAAgB,CAAC,CAAC;IAEzC,OAAO,MAAM,CAAC;AAChB,CAAC;AAEM,KAAK,UAAU,kBAAkB,CACtC,OAAsB;IAEtB,MAAM,WAAW,GAAG,MAAM,IAAA,+BAAiB,EAAC,OAAO,CAAC,CAAC;IAErD,MAAM,IAAI,GAAG,EAAE,GAAG,WAAW,CAAC,YAAY,EAAE,GAAG,WAAW,CAAC,eAAe,EAAE,CAAC;IAC7E,MAAM,GAAG,GAAG,CAAC,IAAY,EAAE,EAAE,CAAC,IAAI,IAAI,IAAI,CAAC;IAC3C,MAAM,UAAU,GAAG,KAAK,EAAE,QAAkB,EAAE,EAAE;QAC9C,MAAM,OAAO,GAAG,MAAM,IAAA,mBAAE,EAAC,QAAQ,EAAE;YACjC,GAAG,EAAE,OAAO,CAAC,UAAU;YACvB,QAAQ,EAAE,KAAK;YACf,SAAS,EAAE,IAAI;YACf,MAAM,EAAE,CAAC,oBAAoB,CAAC;SAC/B,CAAC,CAAC;QACH,OAAO,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC;IAC5B,CAAC,CAAC;IAEF,cAAc;IACd,IAAI,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,UAAU,CAAC,CAAC,gCAAgC,CAAC,CAAC,CAAC,EAAE,CAAC;QAC1E,OAAO,cAAc,CAAC;IACxB,CAAC;IAED,uBAAuB;IACvB,IACE,GAAG,CAAC,eAAe,CAAC;QACpB,GAAG,CAAC,kBAAkB,CAAC;QACvB,CAAC,MAAM,UAAU,CAAC,CAAC,wBAAwB,CAAC,CAAC,CAAC,EAC9C,CAAC;QACD,OAAO,YAAY,CAAC;IACtB,CAAC;IAED,4CAA4C;IAC5C,wHAAwH;IACxH,IAAI,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,UAAU,CAAC,CAAC,gCAAgC,CAAC,CAAC,CAAC,EAAE,CAAC;QAC1E,OAAO,cAAc,CAAC;IACxB,CAAC;IAED,gBAAgB;IAChB,IACE,GAAG,CAAC,eAAe,CAAC;QACpB,CAAC,MAAM,UAAU,CAAC,CAAC,0BAA0B,CAAC,CAAC,CAAC,EAChD,CAAC;QACD,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,iCAAiC;IACjC,IACE,GAAG,CAAC,iBAAiB,CAAC;QACtB,CAAC,MAAM,UAAU,CAAC,CAAC,4BAA4B,CAAC,CAAC,CAAC,EAClD,CAAC;QACD,OAAO,cAAc,CAAC;IACxB,CAAC;IAED,6BAA6B;IAC7B,IAAI,GAAG,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,UAAU,CAAC,CAAC,yBAAyB,CAAC,CAAC,CAAC,EAAE,CAAC;QAC1E,OAAO,cAAc,CAAC;IACxB,CAAC;IAED,YAAY;IACZ,IAAI,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,UAAU,CAAC,CAAC,6BAA6B,CAAC,CAAC,CAAC,EAAE,CAAC;QACxE,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,iGAAiG;IACjG,OAAO,cAAc,CAAC;AACxB,CAAC","sourcesContent":["import readEnv from 'read-env';\nimport { getPackageDotJson } from './clack-utils';\nimport type { WizardOptions } from './types';\nimport fg from 'fast-glob';\nimport { IS_DEV } from '../lib/constants';\n\nexport function isNonInteractiveEnvironment(): boolean {\n  if (IS_DEV) {\n    return false;\n  }\n\n  if (!process.stdout.isTTY || !process.stderr.isTTY) {\n    return true;\n  }\n\n  return false;\n}\n\nexport function readEnvironment(): Record<string, unknown> {\n  const result = readEnv('POSTHOG_WIZARD');\n\n  return result;\n}\n\nexport async function detectEnvVarPrefix(\n  options: WizardOptions,\n): Promise<string> {\n  const packageJson = await getPackageDotJson(options);\n\n  const deps = { ...packageJson.dependencies, ...packageJson.devDependencies };\n  const has = (name: string) => name in deps;\n  const hasAnyFile = async (patterns: string[]) => {\n    const matches = await fg(patterns, {\n      cwd: options.installDir,\n      absolute: false,\n      onlyFiles: true,\n      ignore: ['**/node_modules/**'],\n    });\n    return matches.length > 0;\n  };\n\n  // --- Next.js\n  if (has('next') || (await hasAnyFile(['**/next.config.{js,ts,mjs,cjs}']))) {\n    return 'NEXT_PUBLIC_';\n  }\n\n  // --- Create React App\n  if (\n    has('react-scripts') ||\n    has('create-react-app') ||\n    (await hasAnyFile(['**/config-overrides.js']))\n  ) {\n    return 'REACT_APP_';\n  }\n\n  // --- Vite (vanilla, TanStack, Solid, etc.)\n  // Note: Vite does not need PUBLIC_ but we use it to follow the docs, to improve the chances of an LLM getting it right.\n  if (has('vite') || (await hasAnyFile(['**/vite.config.{js,ts,mjs,cjs}']))) {\n    return 'VITE_PUBLIC_';\n  }\n\n  // --- SvelteKit\n  if (\n    has('@sveltejs/kit') ||\n    (await hasAnyFile(['**/svelte.config.{js,ts}']))\n  ) {\n    return 'PUBLIC_';\n  }\n\n  // --- TanStack Start (uses Vite)\n  if (\n    has('@tanstack/start') ||\n    (await hasAnyFile(['**/tanstack.config.{js,ts}']))\n  ) {\n    return 'VITE_PUBLIC_';\n  }\n\n  // --- SolidStart (uses Vite)\n  if (has('solid-start') || (await hasAnyFile(['**/solid.config.{js,ts}']))) {\n    return 'VITE_PUBLIC_';\n  }\n\n  // --- Astro\n  if (has('astro') || (await hasAnyFile(['**/astro.config.{js,ts,mjs}']))) {\n    return 'PUBLIC_';\n  }\n\n  // We default to Vite if we can't detect a specific framework, since it's the most commonly used.\n  return 'VITE_PUBLIC_';\n}\n"]}