{"version":3,"file":"add-editor-rules.js","sourceRoot":"","sources":["../../../src/steps/add-editor-rules.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,uCAAyB;AACzB,kDAA0B;AAC1B,gDAAwB;AAExB,kDAA+C;AAC/C,2DAAmC;AACnC,4CAAyC;AAQlC,MAAM,kBAAkB,GAAG,KAAK,EAAE,EACvC,UAAU,EACV,SAAS,EACT,WAAW,GACe,EAAoB,EAAE;IAChD,0CAA0C;IAC1C,IAAI,OAAO,CAAC,GAAG,CAAC,eAAe,EAAE,CAAC;QAChC,OAAO,IAAA,qBAAS,EAAC,kBAAkB,EAAE,KAAK,IAAI,EAAE;YAC9C,MAAM,OAAO,GAAG,cAAI,CAAC,IAAI,CAAC,UAAU,EAAE,SAAS,EAAE,OAAO,CAAC,CAAC;YAE1D,MAAM,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;YAEtD,MAAM,cAAc,GAAG,MAAM,EAAE,CAAC,QAAQ,CAAC,QAAQ,CAC/C,cAAI,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,SAAS,CAAC,EACvD,MAAM,CACP,CAAC;YACF,MAAM,kBAAkB,GAAG,cAAI,CAAC,IAAI,CAClC,SAAS,EACT,IAAI,EACJ,OAAO,EACP,OAAO,EACP,cAAc,CACf,CAAC;YAEF,MAAM,cAAc,GAAG,MAAM,EAAE,CAAC,QAAQ,CAAC,QAAQ,CAC/C,kBAAkB,EAClB,MAAM,CACP,CAAC;YAEF,+DAA+D;YAC/D,MAAM,aAAa,GAAG,cAAc,CAAC,OAAO,CAC1C,aAAa,EACb,cAAc,CACf,CAAC;YACF,MAAM,UAAU,GAAG,cAAI,CAAC,IAAI,CAAC,OAAO,EAAE,yBAAyB,CAAC,CAAC;YAEjE,2BAA2B;YAC3B,MAAM,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,UAAU,EAAE,aAAa,EAAE,MAAM,CAAC,CAAC;YAE/D,qBAAS,CAAC,OAAO,CAAC,oBAAoB,EAAE;gBACtC,MAAM,EAAE,oBAAoB;gBAC5B,WAAW;aACZ,CAAC,CAAC;YAEH,eAAK,CAAC,GAAG,CAAC,IAAI,CACZ,yBAAyB,eAAK,CAAC,IAAI,CAAC,IAAI,CACtC,uCAAuC,CACxC,EAAE,CACJ,CAAC;YAEF,OAAO,IAAI,CAAC;QACd,CAAC,CAAC,CAAC;IACL,CAAC;IAED,OAAO,KAAK,CAAC;AACf,CAAC,CAAC;AAvDW,QAAA,kBAAkB,sBAuD7B","sourcesContent":["import * as fs from 'fs';\nimport chalk from 'chalk';\nimport path from 'path';\nimport { Integration } from '../lib/constants';\nimport { analytics } from '../utils/analytics';\nimport clack from '../utils/clack';\nimport { traceStep } from '../telemetry';\n\ntype AddEditorRulesStepOptions = {\n  installDir: string;\n  rulesName: string;\n  integration: Integration;\n};\n\nexport const addEditorRulesStep = async ({\n  installDir,\n  rulesName,\n  integration,\n}: AddEditorRulesStepOptions): Promise<boolean> => {\n  // Add rules file if in Cursor environment\n  if (process.env.CURSOR_TRACE_ID) {\n    return traceStep('add-editor-rules', async () => {\n      const docsDir = path.join(installDir, '.cursor', 'rules');\n\n      await fs.promises.mkdir(docsDir, { recursive: true });\n\n      const frameworkRules = await fs.promises.readFile(\n        path.join(__dirname, '..', 'utils', 'rules', rulesName),\n        'utf8',\n      );\n      const universalRulesPath = path.join(\n        __dirname,\n        '..',\n        'utils',\n        'rules',\n        'universal.md',\n      );\n\n      const universalRules = await fs.promises.readFile(\n        universalRulesPath,\n        'utf8',\n      );\n\n      // Replace {universal} placeholder with universal rules content\n      const combinedRules = frameworkRules.replace(\n        '{universal}',\n        universalRules,\n      );\n      const targetPath = path.join(docsDir, 'posthog-integration.mdc');\n\n      // Write the combined rules\n      await fs.promises.writeFile(targetPath, combinedRules, 'utf8');\n\n      analytics.capture('wizard interaction', {\n        action: 'added editor rules',\n        integration,\n      });\n\n      clack.log.info(\n        `Added Cursor rules to ${chalk.bold.cyan(\n          `.cursor/rules/posthog-integration.mdc`,\n        )}`,\n      );\n\n      return true;\n    });\n  }\n\n  return false;\n};\n"]}