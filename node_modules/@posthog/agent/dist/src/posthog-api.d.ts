import type { Task, TaskRun, LogEntry, PostHogAPIConfig, PostHogResource, UrlMention, TaskRunArtifact, TaskArtifactUploadPayload } from './types.js';
export interface TaskRunUpdate {
    status?: TaskRun["status"];
    branch?: string | null;
    current_stage?: string | null;
    error_message?: string | null;
    output?: Record<string, unknown> | null;
    state?: Record<string, unknown>;
}
export declare class PostHogAPIClient {
    private config;
    private _teamId;
    constructor(config: PostHogAPIConfig);
    private get baseUrl();
    private get headers();
    private apiRequest;
    getTeamId(): number;
    getBaseUrl(): string;
    getApiKey(): string;
    getLlmGatewayUrl(): string;
    fetchTask(taskId: string): Promise<Task>;
    listTasks(filters?: {
        repository?: string;
        organization?: string;
        origin_product?: string;
    }): Promise<Task[]>;
    updateTask(taskId: string, updates: Partial<Task>): Promise<Task>;
    listTaskRuns(taskId: string): Promise<TaskRun[]>;
    getTaskRun(taskId: string, runId: string): Promise<TaskRun>;
    createTaskRun(taskId: string, payload?: Partial<Omit<TaskRun, 'id' | 'task' | 'team' | 'created_at' | 'updated_at' | 'completed_at'>>): Promise<TaskRun>;
    updateTaskRun(taskId: string, runId: string, payload: TaskRunUpdate): Promise<TaskRun>;
    setTaskRunOutput(taskId: string, runId: string, output: Record<string, unknown>): Promise<TaskRun>;
    appendTaskRunLog(taskId: string, runId: string, entries: LogEntry[]): Promise<TaskRun>;
    uploadTaskArtifacts(taskId: string, runId: string, artifacts: TaskArtifactUploadPayload[]): Promise<TaskRunArtifact[]>;
    /**
     * Fetch logs from S3 using presigned URL from TaskRun
     * @param taskRun - The task run containing the log_url
     * @returns Array of log entries, or empty array if no logs available
     */
    fetchTaskRunLogs(taskRun: TaskRun): Promise<LogEntry[]>;
    /**
     * Fetch error details from PostHog error tracking
     */
    fetchErrorDetails(errorId: string, projectId?: string): Promise<PostHogResource>;
    /**
     * Generic resource fetcher by URL or ID
     */
    fetchResourceByUrl(urlMention: UrlMention): Promise<PostHogResource>;
    /**
     * Format error data for agent consumption
     */
    private formatErrorContent;
}
//# sourceMappingURL=posthog-api.d.ts.map