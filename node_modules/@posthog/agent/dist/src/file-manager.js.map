{"version":3,"file":"file-manager.js","sources":["../../src/file-manager.ts"],"sourcesContent":["import { promises as fs } from 'fs';\nimport { join, extname } from 'path';\nimport type { SupportingFile, ResearchEvaluation } from './types.js';\nimport { Logger } from './utils/logger.js';\n\nexport interface TaskFile {\n  name: string;\n  content: string;\n  type: 'plan' | 'context' | 'reference' | 'output' | 'artifact';\n}\n\nexport interface LocalArtifact {\n  name: string;\n  content: string;\n  type: TaskFile['type'];\n  contentType: string;\n  size: number;\n}\n\nexport class PostHogFileManager {\n  private repositoryPath: string;\n  private logger: Logger;\n\n  constructor(repositoryPath: string, logger?: Logger) {\n    this.repositoryPath = repositoryPath;\n    this.logger = logger || new Logger({ debug: false, prefix: '[FileManager]' });\n  }\n\n  private getTaskDirectory(taskId: string): string {\n    return join(this.repositoryPath, '.posthog', taskId);\n  }\n\n  private getTaskFilePath(taskId: string, fileName: string): string {\n    return join(this.getTaskDirectory(taskId), fileName);\n  }\n\n  async ensureTaskDirectory(taskId: string): Promise<void> {\n    const taskDir = this.getTaskDirectory(taskId);\n    try {\n      await fs.access(taskDir);\n    } catch {\n      await fs.mkdir(taskDir, { recursive: true });\n    }\n  }\n\n  async writeTaskFile(taskId: string, file: TaskFile): Promise<void> {\n    await this.ensureTaskDirectory(taskId);\n    const filePath = this.getTaskFilePath(taskId, file.name);\n\n    this.logger.debug('Writing task file', {\n      filePath,\n      contentLength: file.content.length,\n      contentType: typeof file.content\n    });\n\n    await fs.writeFile(filePath, file.content, 'utf8');\n\n    this.logger.debug('File written successfully', { filePath });\n  }\n\n  async readTaskFile(taskId: string, fileName: string): Promise<string | null> {\n    try {\n      const filePath = this.getTaskFilePath(taskId, fileName);\n      return await fs.readFile(filePath, 'utf8');\n    } catch (error) {\n      if ((error as NodeJS.ErrnoException).code === 'ENOENT') {\n        return null;\n      }\n      throw error;\n    }\n  }\n\n  async listTaskFiles(taskId: string): Promise<string[]> {\n    try {\n      const taskDir = this.getTaskDirectory(taskId);\n      const files = await fs.readdir(taskDir);\n      return files.filter(file => !file.startsWith('.'));\n    } catch (error) {\n      if ((error as NodeJS.ErrnoException).code === 'ENOENT') {\n        return [];\n      }\n      throw error;\n    }\n  }\n\n  async deleteTaskFile(taskId: string, fileName: string): Promise<void> {\n    try {\n      const filePath = this.getTaskFilePath(taskId, fileName);\n      await fs.unlink(filePath);\n    } catch (error) {\n      if ((error as NodeJS.ErrnoException).code !== 'ENOENT') {\n        throw error;\n      }\n    }\n  }\n\n  async taskDirectoryExists(taskId: string): Promise<boolean> {\n    try {\n      const taskDir = this.getTaskDirectory(taskId);\n      await fs.access(taskDir);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  async cleanupTaskDirectory(taskId: string): Promise<void> {\n    try {\n      const taskDir = this.getTaskDirectory(taskId);\n      await fs.rm(taskDir, { recursive: true, force: true });\n    } catch (error) {\n      if ((error as NodeJS.ErrnoException).code !== 'ENOENT') {\n        throw error;\n      }\n    }\n  }\n\n  // Convenience methods for common file types\n  async writePlan(taskId: string, plan: string): Promise<void> {\n    this.logger.debug('Writing plan', {\n      taskId,\n      planLength: plan.length,\n      contentPreview: plan.substring(0, 200)\n    });\n\n    await this.writeTaskFile(taskId, {\n      name: 'plan.md',\n      content: plan,\n      type: 'plan'\n    });\n\n    this.logger.info('Plan file written', { taskId });\n  }\n\n  async readPlan(taskId: string): Promise<string | null> {\n    return await this.readTaskFile(taskId, 'plan.md');\n  }\n\n  async writeContext(taskId: string, context: string): Promise<void> {\n    await this.writeTaskFile(taskId, {\n      name: 'context.md',\n      content: context,\n      type: 'context'\n    });\n  }\n\n  async readContext(taskId: string): Promise<string | null> {\n    return await this.readTaskFile(taskId, 'context.md');\n  }\n\n  async writeRequirements(taskId: string, requirements: string): Promise<void> {\n    await this.writeTaskFile(taskId, {\n      name: 'requirements.md',\n      content: requirements,\n      type: 'reference'\n    });\n  }\n\n  async readRequirements(taskId: string): Promise<string | null> {\n    return await this.readTaskFile(taskId, 'requirements.md');\n  }\n\n  async writeResearch(taskId: string, data: ResearchEvaluation): Promise<void> {\n    this.logger.debug('Writing research', {\n      taskId,\n      score: data.actionabilityScore,\n      hasQuestions: !!data.questions,\n      questionCount: data.questions?.length ?? 0,\n      answered: data.answered ?? false,\n    });\n\n    await this.writeTaskFile(taskId, {\n      name: 'research.json',\n      content: JSON.stringify(data, null, 2),\n      type: 'artifact'\n    });\n\n    this.logger.info('Research file written', { \n      taskId, \n      score: data.actionabilityScore,\n      hasQuestions: !!data.questions,\n      answered: data.answered ?? false,\n    });\n  }\n\n  async readResearch(taskId: string): Promise<ResearchEvaluation | null> {\n    try {\n      const content = await this.readTaskFile(taskId, 'research.json');\n      return content ? JSON.parse(content) as ResearchEvaluation : null;\n    } catch (error) {\n      this.logger.debug('Failed to parse research.json', { error });\n      return null;\n    }\n  }\n\n  async writeTodos(taskId: string, data: any): Promise<void> {\n    this.logger.debug('Writing todos', {\n      taskId,\n      total: data.metadata?.total ?? 0,\n      completed: data.metadata?.completed ?? 0,\n    });\n\n    await this.writeTaskFile(taskId, {\n      name: 'todos.json',\n      content: JSON.stringify(data, null, 2),\n      type: 'artifact'\n    });\n\n    this.logger.info('Todos file written', {\n      taskId,\n      total: data.metadata?.total ?? 0,\n      completed: data.metadata?.completed ?? 0,\n    });\n  }\n\n  async readTodos(taskId: string): Promise<any | null> {\n    try {\n      const content = await this.readTaskFile(taskId, 'todos.json');\n      return content ? JSON.parse(content) : null;\n    } catch (error) {\n      this.logger.debug('Failed to parse todos.json', { error });\n      return null;\n    }\n  }\n\n  async getTaskFiles(taskId: string): Promise<SupportingFile[]> {\n    const fileNames = await this.listTaskFiles(taskId);\n    const files: SupportingFile[] = [];\n    \n    for (const fileName of fileNames) {\n      const content = await this.readTaskFile(taskId, fileName);\n      if (content !== null) {\n        // Determine type based on file name\n        const type = this.resolveFileType(fileName);\n        \n        files.push({\n          name: fileName,\n          content,\n          type,\n          created_at: new Date().toISOString() // Could be enhanced with file stats\n        });\n      }\n    }\n    \n    return files;\n  }\n\n  async collectTaskArtifacts(taskId: string): Promise<LocalArtifact[]> {\n    const fileNames = await this.listTaskFiles(taskId);\n    const artifacts: LocalArtifact[] = [];\n\n    for (const fileName of fileNames) {\n      const content = await this.readTaskFile(taskId, fileName);\n      if (content === null) {\n        continue;\n      }\n\n      const type = this.resolveFileType(fileName);\n      const contentType = this.inferContentType(fileName);\n      const size = Buffer.byteLength(content, 'utf8');\n\n      artifacts.push({\n        name: fileName,\n        content,\n        type,\n        contentType,\n        size,\n      });\n    }\n\n    return artifacts;\n  }\n\n  private resolveFileType(fileName: string): TaskFile['type'] {\n    if (fileName === 'plan.md') return 'plan';\n    if (fileName === 'context.md') return 'context';\n    if (fileName === 'requirements.md') return 'reference';\n    if (fileName.startsWith('output_')) return 'output';\n    if (fileName.endsWith('.md')) return 'reference';\n    return 'artifact';\n  }\n\n  private inferContentType(fileName: string): string {\n    const extension = extname(fileName).toLowerCase();\n    switch (extension) {\n      case '.md':\n        return 'text/markdown';\n      case '.json':\n        return 'application/json';\n      case '.txt':\n        return 'text/plain';\n      default:\n        return 'text/plain';\n    }\n  }\n}\n"],"names":["fs"],"mappings":"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"}