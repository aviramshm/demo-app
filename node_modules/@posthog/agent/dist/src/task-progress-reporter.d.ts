import type { Logger } from './utils/logger.js';
import type { PostHogAPIClient } from './posthog-api.js';
import type { AgentEvent } from './types.js';
interface ProgressMetadata {
    totalSteps?: number;
}
/**
 * Persists task execution progress to PostHog so clients can poll for updates.
 *
 * The reporter is intentionally best-effort â€“ failures are logged but never
 * allowed to break the agent execution flow.
 */
export declare class TaskProgressReporter {
    private posthogAPI?;
    private logger;
    private taskRun?;
    private taskId?;
    private outputLog;
    private totalSteps?;
    private lastLogEntry?;
    private tokenBuffer;
    private tokenCount;
    private tokenFlushTimer?;
    private readonly TOKEN_BATCH_SIZE;
    private readonly TOKEN_FLUSH_INTERVAL_MS;
    private logWriteQueue;
    private readonly LOG_APPEND_MAX_RETRIES;
    private readonly LOG_APPEND_RETRY_BASE_DELAY_MS;
    constructor(posthogAPI: PostHogAPIClient | undefined, logger: Logger);
    get runId(): string | undefined;
    start(taskId: string, metadata?: ProgressMetadata): Promise<void>;
    complete(): Promise<void>;
    fail(error: Error | string): Promise<void>;
    appendLog(line: string): Promise<void>;
    private flushTokens;
    private scheduleTokenFlush;
    private appendLogEntry;
    private writeLogEntry;
    recordEvent(event: AgentEvent): Promise<void>;
    private update;
}
export {};
//# sourceMappingURL=task-progress-reporter.d.ts.map