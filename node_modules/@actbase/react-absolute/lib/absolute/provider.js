import { __assign } from "tslib";
import * as React from 'react';
import { useEffect } from 'react';
import { AbsoluteContext } from './context';
export var attachMethod = undefined;

var AbsoluteProvider = function (props) {
  var config = React.useRef({
    ix: 0
  });

  var _a = React.useState({}),
      screens = _a[0],
      setScreens = _a[1];

  var attach = React.useCallback(function (_ix, component) {
    var ix = _ix ? _ix : config.current.ix + 1;
    setScreens(function (screens) {
      var _a;

      return __assign(__assign({}, screens), (_a = {}, _a[String(ix)] = component, _a));
    });

    if (!_ix) {
      config.current.ix = ix;
    }

    return String(ix);
  }, []);
  useEffect(function () {
    attachMethod = attach;
  }, [attach]);
  return React.createElement(React.Fragment, null, React.createElement(AbsoluteContext.Provider, {
    value: {
      attach: attach
    }
  }, props.children), Object.keys(screens).filter(function (v) {
    return !!screens[v];
  }).map(function (key) {
    return screens[key];
  }));
};

export default AbsoluteProvider;