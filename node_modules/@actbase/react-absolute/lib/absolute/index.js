import { useContext, useEffect, useRef } from 'react';
import { AbsoluteContext } from './context';
import AbsoluteProvider, { attachMethod } from './provider';

var Absolute = function (props) {
  var serial = useRef({
    ix: ''
  });
  var attach = useContext(AbsoluteContext).attach;
  useEffect(function () {
    if (attach) {
      serial.current.ix = attach(serial.current.ix, props.children);
      return function () {
        attach(serial.current.ix, undefined);
      };
    } else {
      return function () {
        return null;
      };
    }
  }, [attach, props]);
  return null;
};

Absolute.defaultProps = {};
Absolute.Provider = AbsoluteProvider;

Absolute.add = function (elem) {
  var ix = attachMethod(undefined, elem);
  return function () {
    return attachMethod(ix, undefined);
  };
};

export default Absolute;